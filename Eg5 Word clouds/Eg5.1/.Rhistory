library(tm)
library(wordcloud)
library(pdftools)
library(tidyr)
library(ggwordcloud)
## BORIC
corpus <- pdf_text("ProgramaKast.pdf") %>% strsplit(split = "\n")
## BORIC
corpus <- pdf_text("ProgramaKast.pdf") %>% strsplit(split = "\n")
corpus <- Corpus(VectorSource(corpus))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removeWords, stopwords("spanish"))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, stripWhitespace)
m <- as.matrix(TermDocumentMatrix(corpus))
v <- sort(rowSums(m), decreasing = TRUE)
d <- data.frame(word = names(v), freq=v)
# wordcloud(d$word, d$freq, random.order= FALSE, rot.per=0.3,
#           scale=c(4,.5), max.words=101, colors= brewer.pal(8,"Dark2"))
plot1 <- ggplot(d[1:42,], aes(label = word,
size=freq,
color = factor(sample.int(10, nrow(d[1:42,]), replace =T)))) +
geom_text_wordcloud() +
scale_size_area(max_size = 10) +
ggtitle("Palabras mÃ¡s usadas en el programa de Boric") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, vjust = -2))
plot1
